"use strict";(self["webpackChunk_amp_ui_commerce_commerce_web_app"]=self["webpackChunk_amp_ui_commerce_commerce_web_app"]||[]).push([[87488],{25841:(e,t,n)=>{n.d(t,{DD:()=>I});class i{constructor(){this.registry=new Map}emit(e,...t){var n;const i=null!==(n=this.registry.get(e))&&void 0!==n?n:[];for(const s of i)s(...t)}on(e,t){{let n=this.registry.get(e);n||this.registry.set(e,n=new Set),n.add(t)}const n=()=>{const n=this.registry.get(e);return!(!n||!n.has(t))&&(1===n.size?this.registry.delete(e):n.delete(t))};return n}getListeners(e){const t=this.registry.get(e);return t?[...t]:[]}}const s=["keypress","keydown","click","mousemove","scroll","touchmove","touchstart"];let o=Date.now();const a=()=>{o=Date.now()};s.forEach((e=>{window.addEventListener(e,a,!1)}));const r=(e,{interval:t=1e4,threshold:n=6e4}={})=>{let i=!1;const s=setInterval((()=>{const t=Date.now()-o>=n;i!==t&&(i=t,e(i))}),t);return()=>clearInterval(s)},c=e=>(e+256).toString(16).substr(1),h=e=>crypto.getRandomValues(new Uint8Array(e)),d=[4,6,8,10],l=()=>{const e=h(16);e[6]=15&e[6]|64,e[8]=63&e[8]|128;let t="";for(let n=0;n<e.length;n++)d.includes(n)&&(t+="-"),t+=c(e[n]);return t};function u(e,t){return e.width===t.width&&e.height===t.height}function g(e){let t;if(e.contentBoxSize)if(e.contentBoxSize[0])t={width:e.contentBoxSize[0].inlineSize,height:e.contentBoxSize[0].blockSize};else{const n=e.contentBoxSize;t={width:n.inlineSize,height:n.blockSize}}else t={width:e.contentRect.width,height:e.contentRect.height};return t}function m(e,t){let n;const i=new ResizeObserver((e=>{for(const i of e){const e=g(i);n&&u(n,e)||(n=e,t(e))}}));return i.observe(e),()=>i.disconnect()}let w=-1,p=0;function v(e){let t="";const n=Date.now();return w===n?p++:(p=0,w=n),t+=n+"-"+p,e&&(t=e+t),t}const S="winio:",y=(e,t)=>`${S}${e}${JSON.stringify(t)}`,f=(e,t)=>{const n=t.substring(S.length+e.length);return JSON.parse(n)},C=(e,t)=>"string"===typeof t&&t.startsWith(S)&&t.substr(S.length,e.length)===e,k=3,E=5e3,D=new Set(["SYN","SYN/ACK","ACK"]),M=new Set([...D,"connected"]);class A extends i{constructor(e,t,{source:n=window,timeout:i=E,namespace:s=""}={}){if(super(),this.target=e,this.targetOrigin=t,this.preConnectionEvents=[],"*"===t)throw new Error("targetOrigin can not be '*'");if(t.split("*").length>2)throw new Error("targetOrigin can only use 1 wildcard '*'");this.source=n,this.namespace=s,this.isConnected=!1,this.isListening=!1,this.timeout=i,this.logs=[]}handleMessageEvent(e){const t=this.targetOrigin.split("*"),n=t.length>1,i=n?e.origin.startsWith(t[0])&&e.origin.endsWith(t[1]):e.origin===this.targetOrigin;if(i&&e.source===this.target&&C(this.namespace,e.data)){const t=f(this.namespace,e.data),{winio:i,event:s}=t;D.has(s.name)||this.isConnected&&i.cid===this.connectionID?(n&&"SYN"===s.name&&(this.targetOrigin=e.origin),this.log({type:"on",data:t}),super.emit(s.name,s.payload)):this.preConnectionEvents.push(e)}}async startHandshake(){let e=0,t=0,n=Math.ceil(this.timeout/2**k);while(e<k)try{return e===k-1&&n<this.timeout-t&&(n=this.timeout-t),void await this.attemptHandshake(n)}catch{t+=n,e+=1,n*=2}throw new Error("Handshake failed")}attemptHandshake(e){return this.handshakePromise=new Promise(((t,n)=>{this.resolveHandshake=t,setTimeout((()=>{this.isConnected||n()}),e)})),this.internalEmit("SYN",{connectionID:v()}),this.handshakePromise}handshakeAcknowledged(e,t){var n;this.isConnected=!0,this.connectionID=e,null===(n=this.resolveHandshake)||void 0===n||n.call(this),super.emit("connected",t),this.preConnectionEvents.length>0&&(this.preConnectionEvents.forEach((e=>{this.handleMessageEvent(e)})),this.preConnectionEvents=[])}emit(e,t){if(M.has(e))throw new Error(`"${e}" is a reserve event.`);if(!this.isConnected)throw new Error("Connection has to be establish before emitting events.");this.internalEmit(e,t)}internalEmit(e,t){const n={winio:{cid:this.connectionID,eid:v()},event:{name:e,payload:t}};this.log({type:"emit",data:n}),this.target.postMessage(y(this.namespace,n),this.targetOrigin)}open(e){if(this.isListening)throw new Error("Can't use both 'open' and 'connect' in the same connection");this.on("SYN",(t=>{this.internalEmit("SYN/ACK",{connectionID:t.connectionID,data:e})})),this.on("SYN/ACK",(t=>{this.internalEmit("ACK",{connectionID:t.connectionID,data:e}),this.handshakeAcknowledged(t.connectionID,t.data)})),this.on("ACK",(e=>{this.handshakeAcknowledged(e.connectionID,e.data)})),this.source.addEventListener("message",(e=>this.handleMessageEvent(e)),!1),this.isListening=!0}connect(e={}){if(this.isListening)throw new Error("Can't use both 'open' and 'connect' in the same connection");if(this.targetOrigin.includes("*"))throw new Error("Can't use 'connect' with a targetOrigin that uses a wildcard, please use 'open' instead to wait for a connection.");return this.open(e.data),this.startHandshake()}getLogs(){return this.logs}log(e){this.logs.push(e)}}const b="cwadl_",L=()=>{const e=new URLSearchParams(window.location.search),t=new URLSearchParams;for(const[n,i]of e.entries())n.startsWith(b)&&t.append(n.slice(b.length,n.length),i);return{searchParams:t,search:t.toString()}},P=6e4;class I{constructor(e,t){this.version="0.5.6",this.isIdle=!1,this.internalEvents=new i,this._deepLink=L(),this.connection=new A(window.parent,e,{namespace:"amk:module"}),this.connecting=this.connection.connect({data:{version:this.version}}),this._configuration=this.connecting.then((()=>(this.emit("getConfiguration"),this.registerEvent("configuration").then((e=>(e.deepLink&&(e.deepLink.searchParams=new URLSearchParams(e.deepLink.search)),e)))))),this.connecting.then((()=>{if(null===t||void 0===t?void 0:t.autoResize){const{width:e,height:n}=t.autoResize.getBoundingClientRect();this.connection.emit("resize",{width:e,height:n}),m(t.autoResize,(e=>{this.connection.emit("resize",e)}))}setInterval((()=>{this.connection.emit("status",{idle:this.isIdle})}),P)})),r((e=>{this.isIdle=e})),this.connection.on("willBeShown",(async(e,t)=>{const n=this.internalEvents.getListeners("_willBeShown"),i=[];for(const s of n)i.push(s(e,t));await Promise.all(i),this.connection.emit("willBeShownResolved")}))}async emit(e,t){await this.connecting,this.connection.emit(e,t)}get configuration(){return this._configuration}show(){this.readyToBeShown()}readyToBeShown(){this.emit("readyToBeShown")}hide(e){this.close(e&&{data:e})}close(e={}){this.emit("close",e)}openModule(e,t={}){return new Promise(((n,i)=>{const s=l(),o=this.connection.on("moduleClosed",(({uuid:e,data:t})=>{e===s&&(r(),n(t))})),a=this.connection.on("openModuleFailed",(({uuid:e})=>{e===s&&(r(),i())}));function r(){o(),a()}this.emit("openModule",{name:e,uuid:s,options:t})}))}pushModule(e,t={}){return new Promise(((n,i)=>{const s=this.connection.on("pushModuleResolved",(({data:e})=>{a(),n(e)})),o=this.connection.on("pushModuleFailed",(()=>{a(),i()}));function a(){s(),o()}this.emit("pushModule",{name:e,options:t})}))}popModule(e={}){this.emit("popModule",{destroy:!0,...e})}renewAuthTokens(){return this.emit("renewAuthTokens"),this.registerEvent("authTokensRenewed")}registerEvent(e,t){return new Promise(((n,i)=>{const s=this.connection.on(e,(e=>{s(),t?t(e,n,i):n(e)}))}))}continueOnDevice(e,{onEvent:t,...n}={}){if(this.emit("continueOnDevice",[e,n]),t){const e=this.connection.on("continueOnDeviceSuccess",(()=>{e(),t("success")})),n=this.connection.on("continueOnDeviceError",(()=>{n(),t("error")})),i=this.connection.on("continueOnDeviceDismissed",(()=>{i(),t("dismissed")}))}return this.registerEvent("continueOnDeviceSettled")}challengeWith(e){return this.emit("challengeWith",e),this.registerEvent("challengeWithSettled",((e,t,n)=>{(null===e||void 0===e?void 0:e.challengeCancelled)?n(e):t()}))}onMessage(e,t){return this.connection.on("amkClientMessage",(n=>{n.messageName===e&&t({source:n.source,...n.data?{data:n.data}:{}})}))}emitMessage(e,t,n={}){this.emit("amkClientMessage",{target:t,messageName:e,data:n.data})}onWillBeShown(e){return this.internalEvents.on("_willBeShown",e)}onWasShown(e){return this.connection.on("wasShown",e)}navigateToSection(e){return this.emit("navigateToSection",{section:e})}get deepLink(){return this._deepLink}}var _,O;(function(e){e["Password"]="password"})(_||(_={})),function(e){e["FamilySharing"]="familySharing",e["ManageSubscriptions"]="manageSubscriptions",e["PaymentShipping"]="paymentShipping",e["Wallet"]="wallet",e["AccountRecovery"]="accountRecovery",e["LegacyContact"]="legacyContact",e["ManageCustodian"]="manageCustodian",e["PasswordAndSecurity"]="passwordAndSecurity",e["PersonalInformation"]="personalInfo",e["AddSecurityKeys"]="addSecurityKeys",e["ManageSecurityKeys"]="manageSecurityKeys",e["CoverageCentral"]="coverageCentral"}(O||(O={}))},63031:(e,t,n)=>{n.d(t,{hg:()=>c});const i=["keypress","keydown","click","mousemove","scroll","touchmove","touchstart"];let s=Date.now();const o=()=>{s=Date.now()};i.forEach((e=>{window.addEventListener(e,o,!1)}));const a=new Set(["SYN","SYN/ACK","ACK"]);new Set([...a,"connected"]);var r,c;(function(e){e["Password"]="password"})(r||(r={})),function(e){e["FamilySharing"]="familySharing",e["ManageSubscriptions"]="manageSubscriptions",e["PaymentShipping"]="paymentShipping",e["Wallet"]="wallet",e["AccountRecovery"]="accountRecovery",e["LegacyContact"]="legacyContact",e["ManageCustodian"]="manageCustodian",e["PasswordAndSecurity"]="passwordAndSecurity",e["PersonalInformation"]="personalInfo",e["AddSecurityKeys"]="addSecurityKeys",e["ManageSecurityKeys"]="manageSecurityKeys",e["CoverageCentral"]="coverageCentral"}(c||(c={}))},36478:(e,t,n)=>{e.exports=n.p+"static-commerce/img/AccountPortal.45adc197.svg"}}]);
